<?xml version="1.0"?>
<!-- map : gets used inside controls -->
<!-- control : gets used inside sequences -->
<!-- sequence : can take argument list like seq:arg0:arg1:arg2 -->
<root>
  <map>
    <name>onoff</name>
    <doc>assertive high map for on/off</doc>
    <params on="1" off="0"></params>
  </map>
  <map>
    <name>onoff_i</name>
    <doc>assertive low map for on/off</doc>
    <params on="0" off="1"></params>
  </map>
  <map>
    <name>yesno</name>
    <doc>assertive high map for yes/no</doc>
    <params yes="1" no="0"></params>
  </map>
  <map>
    <name>yesno_i</name>
    <doc>assertive low map for yes/no</doc>
    <params yes="0" no="1"></params>
  </map>
  <map>
    <name>i2c_mux</name>
    <doc>4 to 1 mux to steer ftdi i2c bus to different sets of
    adcs.</doc>
    <params local_adc_ch0="0" local_adc_ch1="1" remote_adc="2"
    reserved="3" loc0="0" loc1="1" rem="2" res="3"></params>
  </map>
  <!-- ******************** Interface A gpios ******************** -->
  <control>
    <name>warm_reset</name>
    <doc>Reset the device warmly</doc>
    <params interface="1" drv="gpio" offset="5" map="onoff_i">
    </params>
  </control>
  <control>
    <name>dut_spare1_in</name>
    <doc>gpio spare1 from DUT (read-only)</doc>
    <params cmd="get" interface="1" drv="gpio" offset="6"
    map="onoff"></params>
  </control>
  <!-- ******************** Interface B gpios ******************** -->
  <map>
    <name>kbd_m1</name>
    <doc>TODO(tbroch) determine what keys these choices hit and
    name maps accordingly</doc>
    <params r1_c2="0" r2_c2="1" r3_c2="2"></params>
  </map>
  <control>
    <name>kbd_m1</name>
    <doc>create key presses row1|row2|row3 and col2</doc>
    <params interface="2" drv="gpio" offset="4" width="2"
    map="kbd_m1"></params>
  </control>
  <map>
    <name>kbd_m2</name>
    <doc>TODO(tbroch) determine what keys these choices hit and
    name maps accordingly</doc>
    <params r1_c1="0" r2_c1="1" r3_c1="2"></params>
  </map>
  <control>
    <name>kbd_m2</name>
    <doc>create key presses row1|row2|row3 and col1</doc>
    <params interface="2" drv="gpio" offset="6" width="2"
    map="kbd_m2"></params>
  </control>
  <!-- ******************** Interface C gpios ******************** -->
  <!-- TODO(tbroch) implement uart + gpio controls -->
  <!-- TODO(jguerin) hacks for now so I can do EC SPI -->
  <control>
    <name>servo_dut_tx</name>
    <doc>Make input when in EC SPI programming mode</doc>
    <params interface="3" drv="gpio" offset="0" map="onoff">
    </params>
  </control>
  <!-- ******************** Interface D gpios ******************** -->
  <control>
    <name>kbd_en</name>
    <doc>Enable servo to assert certain keypresses via kdb_m1 and
    kbd_m2</doc>
    <params interface="4" drv="gpio" offset="0" map="onoff">
    </params>
  </control>
  <control>
    <name>rec_mode</name>
    <doc>Partner specific recovery mode</doc>
    <params interface="4" drv="gpio" offset="1" map="onoff_i">
    </params>
  </control>
  <control>
    <name>dev_mode</name>
    <doc>Developer mode</doc>
    <params interface="4" drv="gpio" offset="2" map="onoff">
    </params>
  </control>
  <control>
    <name>lid_open</name>
    <doc>lid open gpio</doc>
    <params interface="4" drv="gpio" offset="3" map="yesno">
    </params>
  </control>
  <map>
    <name>press</name>
    <doc>map for press and release of buttons</doc>
    <params press="0" release="1"></params>
  </map>
  <control>
    <name>pwr_button</name>
    <doc>power button gpio</doc>
    <params interface="4" drv="gpio" offset="4" map="press">
    </params>
  </control>
  <control>
    <name>goog_rec_mode</name>
    <doc>Google recovery mode</doc>
    <params cmd="set" interface="4" drv="gpio" offset="5"
    map="onoff_i"></params>
    <params cmd="get" interface="2" drv="tca6416" slv="0x20"
    port="1" offset="3" map="onoff_i"></params>
  </control>
  <control>
    <name>cold_reset</name>
    <doc>reset the device frigidly</doc>
    <params interface="4" drv="gpio" offset="6" map="onoff_i">
    </params>
  </control>
  <control>
    <name>mfg_mode</name>
    <doc>Manufacturing mode</doc>
    <params interface="4" drv="gpio" offset="7" map="onoff">
    </params>
  </control>
  <!-- ******************** I2c related controls ******************** -->
  <!-- slv 0x20 : ioexpander port 0 -->
  <!-- TODO(tbroch) implement these controls -->
  <!-- slv 0x20 : ioexpander port 1 -->
  <!-- TODO(tbroch) implement these controls -->
  <map>
    <name>io</name>
    <doc>map for buffer direction</doc>
    <params input="0" output="1"></params>
  </map>
  <control>
    <name>tx_dir</name>
    <doc>Sets the direction of dut tx buffer.</doc>
    <params interface="2" drv="tca6416" slv="0x20" port="1"
    offset="1" map="io" init="input"></params>
  </control>
  <!-- slv 0x21 : ioexpander port 0 -->
  <control>
    <name>dut_hub_on</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="0" map="onoff_i"></params>
  </control>
  <control>
    <name>usb_mux_oe2</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="1" map="onoff_i"></params>
  </control>
  <control>
    <name>usb_mux_oe1</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="2" map="onoff_i"></params>
  </control>
  <control>
    <name>usb_mux_sel1</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="3" map="onoff"></params>
  </control>
  <control>
    <name>dut_hub1_rst1</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="4" map="onoff_i"></params>
  </control>
  <control>
    <name>dut_usb2_prtctl</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="5" map="onoff"></params>
  </control>
  <control>
    <name>dut_hub_sel</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="6" map="onoff"></params>
  </control>
  <control>
    <name>prtctl4_pwren</name>
    <doc>TODO(tbroch) add doc describing control</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="0"
    offset="7" map="onoff"></params>
  </control>
  <!-- slv 0x21 : ioexpander port 1 -->
  <control>
    <name>i2c_mux</name>
    <doc>4to1 mux select which steers i2c bus from FTDI to
    different banks (16) of ina219 adcs</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="0" width="2" map="i2c_mux" init="rem"></params>
  </control>
  <control>
    <name>i2c_mux_en</name>
    <doc>Enable pin (ADG804) of 4to1 mux</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="2" map="onoff" init="on"></params>
  </control>
  <control>
    <name>blinky</name>
    <doc>LED on gpio for blinking</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="3" map="onoff_i"></params>
  </control>
  <control>
    <name>dut_hub_pwren</name>
    <doc>enable power to DUT's USB hub</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="5" map="onoff"></params>
  </control>
  <control>
    <name>pwren_gate</name>
    <doc>Enable drivers for JTAG/SPI and UART IO's</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="7" map="onoff_i"></params>
  </control>
  <control>
    <name>ec_spi</name>
    <doc>Enable power to DUT for programming EC SPI Flash</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="4" map="onoff_i"></params>
  </control>
  <control>
    <name>spi_flash</name>
    <doc>Enable power to DUT for programming BIOS SPI Flash</doc>
    <params interface="2" drv="tca6416" slv="0x21" port="1"
    offset="6" map="onoff_i"></params>
  </control>
  <!-- ******************** Sequences **************************** -->
  <sequence>
    <name>i2c_mux_seq</name>
    <params cmdlist="i2c_mux_en:off i2c_mux_add:__arg0__ i2c_mux_en:on">
    </params>
  </sequence>
</root>
